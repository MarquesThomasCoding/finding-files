<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©mo Widget Simple - @imprion91/finding-files</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .demo-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .hero-section {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        .feature-list {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <div class="hero-section">
        <h1>üöÄ D√©mo Widget Simple - @imprion91/finding-files</h1>
        <p>Version simplifi√©e du widget sans modules ES6</p>
    </div>

    <div class="container">
        <div class="demo-card">
            <h2>üìÅ Widget File Finder (Version Simple)</h2>
            <div id="widget-status" class="status success">
                <strong>Statut :</strong> Widget charg√© avec succ√®s ! üéâ
            </div>
            
            <p>Le widget s'affiche automatiquement en haut √† droite de la page et montre tous les fichiers CSS, JS et images utilis√©s.</p>
            
            <div class="feature-list">
                <h5>‚ú® Fonctionnalit√©s :</h5>
                <ul>
                    <li>Affichage permanent en position fixe</li>
                    <li>Analyse automatique des fichiers</li>
                    <li>Groupement par type (CSS, JS, Images)</li>
                    <li>Interface minimaliste</li>
                    <li>Compteur de fichiers</li>
                </ul>
            </div>

            <h5>üíª Utilisation :</h5>
            <div class="code-block">
npm install @imprion91/finding-files
            </div>

            <div class="code-block">
import '@imprion91/finding-files/widget';
// Le widget s'affiche automatiquement !
            </div>

            <p class="mt-3">
                <strong>Regardez en haut √† droite</strong> ‚Üí Le widget affiche les fichiers de cette page !
            </p>
        </div>

        <div class="demo-card">
            <h3>üé® Exemples de fichiers d√©tect√©s</h3>
            <p>Cette page utilise plusieurs fichiers pour d√©montrer le widget :</p>
            
            <div class="row">
                <div class="col-md-4">
                    <h6>CSS</h6>
                    <small>Bootstrap CDN</small>
                </div>
                <div class="col-md-4">
                    <h6>JS</h6>
                    <small>Widget int√©gr√© + Bootstrap</small>
                </div>
                <div class="col-md-4">
                    <h6>Images</h6>
                    <img src="https://via.placeholder.com/50x50/007bff/ffffff?text=Demo" alt="Demo image" class="img-fluid">
                    <img src="https://via.placeholder.com/50x50/28a745/ffffff?text=Test" alt="Test image" class="img-fluid">
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts pour d√©monstration -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <!-- Widget int√©gr√© directement -->
    <script>
        // Version simplifi√©e du FileFinder
        class SimpleFileFinder {
            constructor(options = {}) {
                this.options = {
                    includeCSS: true,
                    includeJS: true,
                    includeImages: true,
                    ...options
                };
            }

            async findFiles() {
                const files = [];
                
                if (this.options.includeCSS) {
                    files.push(...this.findCSSFiles());
                }
                
                if (this.options.includeJS) {
                    files.push(...this.findJSFiles());
                }
                
                if (this.options.includeImages) {
                    files.push(...this.findImageFiles());
                }
                
                return files;
            }

            findCSSFiles() {
                const links = document.querySelectorAll('link[rel="stylesheet"]');
                return Array.from(links).map(link => ({
                    url: link.href,
                    name: this.extractFileName(link.href),
                    type: 'css'
                }));
            }

            findJSFiles() {
                const scripts = document.querySelectorAll('script[src]');
                return Array.from(scripts).map(script => ({
                    url: script.src,
                    name: this.extractFileName(script.src),
                    type: 'js'
                }));
            }

            findImageFiles() {
                const images = document.querySelectorAll('img[src]');
                return Array.from(images).map(img => ({
                    url: img.src,
                    name: this.extractFileName(img.src),
                    type: 'image'
                }));
            }

            extractFileName(url) {
                try {
                    const urlObj = new URL(url);
                    const pathname = urlObj.pathname;
                    return pathname.split('/').pop() || 'unknown';
                } catch {
                    return url.split('/').pop() || 'unknown';
                }
            }

            groupByType(files) {
                return files.reduce((acc, file) => {
                    if (!acc[file.type]) acc[file.type] = [];
                    acc[file.type].push(file);
                    return acc;
                }, {});
            }
        }

        // Widget simple
        class SimpleFileWidget {
            constructor() {
                this.fileFinder = new SimpleFileFinder();
                this.createWidget();
                this.scanAndDisplay();
            }

            createWidget() {
                this.widgetElement = document.createElement('div');
                this.widgetElement.id = 'simple-file-widget';
                this.widgetElement.innerHTML = `
                    <div class="widget-header">
                        üìÅ Fichiers utilis√©s
                    </div>
                    <div class="widget-content" id="fileContent">
                        <div class="loading">Analyse en cours...</div>
                    </div>
                `;

                this.injectStyles();
                document.body.appendChild(this.widgetElement);
            }

            async scanAndDisplay() {
                try {
                    const files = await this.fileFinder.findFiles();
                    this.displayFiles(files);
                } catch (error) {
                    this.showError('Erreur lors de l\'analyse');
                }
            }

            displayFiles(files) {
                const contentEl = this.widgetElement.querySelector('#fileContent');
                
                if (files.length === 0) {
                    contentEl.innerHTML = '<div class="empty">Aucun fichier trouv√©</div>';
                    return;
                }

                const grouped = this.fileFinder.groupByType(files);
                let html = `<div class="file-count">${files.length} fichier(s)</div>`;

                if (grouped.css && grouped.css.length > 0) {
                    html += `<div class="file-group">
                        <div class="group-title">üé® CSS (${grouped.css.length})</div>
                        ${grouped.css.map(file => `<div class="file-item">${file.name}</div>`).join('')}
                    </div>`;
                }

                if (grouped.js && grouped.js.length > 0) {
                    html += `<div class="file-group">
                        <div class="group-title">‚ö° JS (${grouped.js.length})</div>
                        ${grouped.js.map(file => `<div class="file-item">${file.name}</div>`).join('')}
                    </div>`;
                }

                if (grouped.image && grouped.image.length > 0) {
                    html += `<div class="file-group">
                        <div class="group-title">üñºÔ∏è Images (${grouped.image.length})</div>
                        ${grouped.image.map(file => `<div class="file-item">${file.name}</div>`).join('')}
                    </div>`;
                }

                contentEl.innerHTML = html;
            }

            showError(message) {
                const contentEl = this.widgetElement.querySelector('#fileContent');
                contentEl.innerHTML = `<div class="error">${message}</div>`;
            }

            injectStyles() {
                if (document.getElementById('simple-file-widget-styles')) return;

                const style = document.createElement('style');
                style.id = 'simple-file-widget-styles';
                style.textContent = `
                    #simple-file-widget {
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        width: 300px;
                        max-height: 400px;
                        background: white;
                        border: 2px solid #333;
                        border-radius: 8px;
                        font-family: Arial, sans-serif;
                        font-size: 12px;
                        z-index: 999999;
                        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                        overflow: hidden;
                    }

                    .widget-header {
                        background: #333;
                        color: white;
                        padding: 8px 12px;
                        font-weight: bold;
                        text-align: center;
                    }

                    .widget-content {
                        padding: 12px;
                        max-height: 350px;
                        overflow-y: auto;
                    }

                    .file-count {
                        text-align: center;
                        font-weight: bold;
                        margin-bottom: 10px;
                        color: #666;
                    }

                    .file-group {
                        margin-bottom: 12px;
                    }

                    .group-title {
                        font-weight: bold;
                        margin-bottom: 4px;
                        color: #333;
                        border-bottom: 1px solid #eee;
                        padding-bottom: 2px;
                    }

                    .file-item {
                        padding: 2px 8px;
                        background: #f5f5f5;
                        margin: 2px 0;
                        border-radius: 3px;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        white-space: nowrap;
                    }

                    .loading, .error, .empty {
                        text-align: center;
                        padding: 20px;
                        color: #666;
                    }

                    .error {
                        color: #d32f2f;
                    }
                `;

                document.head.appendChild(style);
            }
        }

        // Auto-initialisation
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                new SimpleFileWidget();
            });
        } else {
            new SimpleFileWidget();
        }
    </script>
</body>
</html> 